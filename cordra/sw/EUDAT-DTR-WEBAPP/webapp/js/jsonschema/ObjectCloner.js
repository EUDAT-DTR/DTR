/*************************************************************************\
    Copyright (c) 2015 Corporation for National Research Initiatives;
                        All rights reserved.
     The CNRI open source license for this software is available at
                  http://hdl.handle.net/20.1000/106
\*************************************************************************/

(function(){
"use strict";

var window = window || self;

var ObjectCloner = {};
window.ObjectCloner = ObjectCloner;

ObjectCloner.clone = function (objectToClone, type, schema) {
    var newObject = jQuery.extend(true, {}, objectToClone);

    var pointerToSchemaMap = SchemaExtractorFactory.get().extract(objectToClone, schema);
    for (var jsonPointer in pointerToSchemaMap) {
        var subSchema = pointerToSchemaMap[jsonPointer];
        var autoGeneratedFieldName = JsonUtil.getDeepProperty(subSchema, Constants.REPOSITORY_SCHEMA_KEYWORD, 'type', 'autoGeneratedField');
        if (!autoGeneratedFieldName) continue;
        JsonUtil.replaceJsonAtPointer(newObject, jsonPointer, null);
    }
    
    //Remove any server set properties
    //Remove any payloads, file names.
    return newObject;
};

})();